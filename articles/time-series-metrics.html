<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time series metrics • buccaneer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time series metrics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">buccaneer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/assemblage-time-series.html">Building time series based on species coexistence</a></li>
    <li><a class="dropdown-item" href="../articles/pre-processing-data.html">pre-processing-data</a></li>
    <li><a class="dropdown-item" href="../articles/time-series-metrics.html">Time series metrics</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Time series metrics</h1>
            
      

      <div class="d-none name"><code>time-series-metrics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Here we will use the same data processed in the article xXXXX.</p>
</div>
<div class="section level2">
<h2 id="loading-data-and-packages">Loading data and packages<a class="anchor" aria-label="anchor" href="#loading-data-and-packages"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"df_TS_TE_faurby"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"df_TS_TE_mass"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"df_occ_faurby"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="clade-level-analysis">Clade level analysis<a class="anchor" aria-label="anchor" href="#clade-level-analysis"></a>
</h3>
<p>Calculating time series at clade level</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_richness</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/regional_clade_richness.html">regional_clade_richness</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_faurby</span>,</span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the results</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_richness</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time.slice <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">richness</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">richness</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Tempo"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Riqueza"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">regional_richness</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="co"># Use a clean theme</span></span></code></pre></div>
<div class="section level4">
<h4 id="regional-clade-trait-distances">regional clade trait distances<a class="anchor" aria-label="anchor" href="#regional-clade-trait-distances"></a>
</h4>
<p>Here we calculate the mean distances using a general function that
allows to set up the group comparison in which the mean will be
calculate. It can be <code>between</code> to calculate mean distances
between a focal and a target group or <code>within</code> to calculate
the mean trait distance only within the focal group</p>
<p>This function is also a general solution to calculate the mean trait
distance using different number of species/genus that are close to each
other. This is set up in the argument <code>nearest.taxon</code>. 1 is
equivalent of mnnd.</p>
<p>Calculating comparing mpd between and within groups using a distance
matrix and a distance threshold (1 = mnnd)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_body_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">df_TS_TE_mass</span><span class="op">$</span><span class="va">mean.size</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># distances between groups using as focal group Caniformia</span></span>
<span><span class="va">regional_mnd_between</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">clade_regional_distance</span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_mass</span>, </span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>,</span>
<span>                          nearest.taxon <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>, </span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                          group <span class="op">=</span> <span class="st">"group"</span>, </span>
<span>                          group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Caniformia"</span>, <span class="st">"Feliformia"</span><span class="op">)</span>, </span>
<span>                          type.comparison <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># distance within the focal group, in this case is Caniformia</span></span>
<span><span class="va">regional_mnd_within</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">clade_regional_distance</span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_mass</span>, </span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>,</span>
<span>                          nearest.taxon <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>, </span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                          group <span class="op">=</span> <span class="st">"group"</span>, </span>
<span>                          group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Caniformia"</span>, <span class="st">"Feliformia"</span><span class="op">)</span>, </span>
<span>                          type.comparison <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></code></pre></div>
<p>Joining all results to plot in one graphic</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_regional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">regional_mnd_between</span>, <span class="va">regional_mnd_within</span><span class="op">)</span></span>
<span><span class="va">all_mnd_regional2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">all_mnd_regional</span>, group_res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Between"</span>, <span class="st">"Within"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">regional_mnd_within</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Plotting mpd results</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_regional2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time.slice.numeric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">time.slice</span>, <span class="st">"_"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice.numeric</span>, y <span class="op">=</span> <span class="va">mean.distance</span>, color <span class="op">=</span> <span class="va">group_res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice.numeric</span>, y <span class="op">=</span> <span class="va">mean.distance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean Distance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="co"># Use a clean theme</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clade-site-richness">Clade site richness<a class="anchor" aria-label="anchor" href="#clade-site-richness"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site_richness</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_site_richness.html">clade_site_richness</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_faurby</span>, </span>
<span>                      df.occ <span class="op">=</span> <span class="va">df_occ_faurby</span>, </span>
<span>                      time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                      round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                      TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                      TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the results</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site_richness</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.richness.site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.richness.site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean site richness"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">site_richness</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="co"># Use a clean theme</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="individual-species-analysis">Individual species analysis<a class="anchor" aria-label="anchor" href="#individual-species-analysis"></a>
</h3>
<div class="section level4">
<h4 id="individual-species-regional-coexistence">Individual species regional coexistence<a class="anchor" aria-label="anchor" href="#individual-species-regional-coexistence"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indiv_species_coex</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpecies_regional_richness.html">IndivSpecies_regional_richness</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_faurby</span>, </span>
<span>                                 time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                                 round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                 species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                                 TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                                 TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
<p>This output contain two data frames, one with all individual
coexistences per species in all time slices, and another containing the
mean species coexistence considering all time slices</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_mean_individual_species</span> <span class="op">&lt;-</span> <span class="va">indiv_species_coex</span><span class="op">$</span><span class="va">mean_species_coexistence</span></span>
<span><span class="va">df_indiv_species_long</span> <span class="op">&lt;-</span> <span class="va">indiv_species_coex</span><span class="op">$</span><span class="va">df_IndivSpp_coexist</span></span></code></pre></div>
<p>We can plot the results of all time mean species coexistence for
three species</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_indiv_species_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Canis"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Ursus"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Ursavus"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">n.coexistence</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_violin</span><span class="op">(</span>trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">n.coexistence</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Espécies"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Coexistência média"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>        panel.grid.major <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">)</span><span class="co"># Use a clean theme</span></span></code></pre></div>
<p>We can also plot the time series for each species</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_indiv_species_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Canis"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Ursavus"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Ursus"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Panthera"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">n.coexistence</span>, color <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">n.coexistence</span>, color <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"number of coexistences by species"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_indiv_species_long</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="co"># Use a clean theme</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="individual-species-regional-mpd">Individual species regional mpd<a class="anchor" aria-label="anchor" href="#individual-species-regional-mpd"></a>
</h4>
<p>We can also plot individual species mpd for all species coexisting in
regional context. For this we will also use data on body mass for all
species. There are different ways in which mpd can be calculated. We can
calculate it using a single trait or a combination of traits. The later
require a distance trait matrix (passed to <code>dist</code> argument)
containing the pairwise distances among species.</p>
<p>Here we show how to calculate mpd using a single trait, in this case
body mass.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_TS_TE_mass2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">df_TS_TE_mass</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">TS</span>, <span class="va">TE</span><span class="op">)</span>, <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">indiv_regional_species_mpd</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/IndivSpecies_regional_mpd.html">IndivSpecies_regional_mpd</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_mass</span>, </span>
<span>                            time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                            trait <span class="op">=</span> <span class="st">"mean.size"</span>,</span>
<span>                            round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                            species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                            TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                            TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_indiv_species_mpd_long</span> <span class="op">&lt;-</span> <span class="va">indiv_regional_species_mpd</span></span></code></pre></div>
<p>Plotting the results for individual species mpd</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_indiv_species_mpd_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Canis"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Ursavus"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Ursus"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Panthera"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">mpd</span>, color <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">mpd</span>, color <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Tempo"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Distância média (mpd)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_indiv_species_mpd_long</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="co"># Use a clean theme</span></span></code></pre></div>
<div class="section level5">
<h5 id="individual-species-regional-mpd-with-varying-distances-and-multiple-traits">Individual species regional mpd with varying distances and multiple
traits<a class="anchor" aria-label="anchor" href="#individual-species-regional-mpd-with-varying-distances-and-multiple-traits"></a>
</h5>
<p>In order to calculate the mpd for multiple traits the user must
inform an object of class dist containing all pairwise distances among
species. The function can handle distances in different ways. It can use
all pairwise distances to obtain the mpd, or the user can inform
throught the argument <code>nearest.taxon</code> the number of nearest
species that will be used to calculate the mpd. The default is
<code>all</code> which is the same as calculating the mpd considering
all species co-occurring in a time slice.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IndivSpecies_regional_mpd.html">IndivSpecies_regional_mpd</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_mass</span>, </span>
<span>                            time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                            trait <span class="op">=</span> <span class="st">"mean.size"</span>,</span>
<span>                            round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                            species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                            TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                            TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="individual-species-site-coexistence">Individual species site coexistence<a class="anchor" aria-label="anchor" href="#individual-species-site-coexistence"></a>
</h4>
<p>Here we will perform the same calculations but using site criteria
for individual species coexistence</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indiv_species_site_coex</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_site_richness.html">IndivSpec_site_richness</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_faurby</span>,</span>
<span>                          df.occ <span class="op">=</span> <span class="va">df_occ_faurby</span>, </span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                          Max.age <span class="op">=</span> <span class="st">"Max.age"</span>,</span>
<span>                          Min.age <span class="op">=</span> <span class="st">"Min.age"</span>,</span>
<span>                          site <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">indiv_species_site_coex2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">indiv_species_site_coex</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time.slice <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>plotting species coexistence considering site coexistence</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indiv_species_site_coex2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Alopecocyon"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Simocyon"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Prepoecilogale"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Vormela"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Hesperocyon"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">mean.per.spp</span>, color <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"mean coexistence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">indiv_species_site_coex2</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="individual-species-site-mpd">Individual species site mpd<a class="anchor" aria-label="anchor" href="#individual-species-site-mpd"></a>
</h4>
<p>We can calculate mean pairwise distances of individual species
coexistence metrics based on site co-occurrence</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_TS_TE_mass3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">df_TS_TE_mass2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span>species <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">indiv_species_site_mpd</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_site_mpd.html">IndivSpec_site_mpd</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_mass3</span>, </span>
<span>                     df.occ <span class="op">=</span> <span class="va">df_occ_faurby</span>, </span>
<span>                     time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                     trait <span class="op">=</span> <span class="st">"mean.size"</span>,</span>
<span>                     round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                     TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                     TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                     Max.age <span class="op">=</span> <span class="st">"Max.age"</span>,</span>
<span>                     Min.age <span class="op">=</span> <span class="st">"Min.age"</span>,</span>
<span>                     site <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="individual-reach-coexistence">Individual reach coexistence<a class="anchor" aria-label="anchor" href="#individual-reach-coexistence"></a>
</h4>
<p>We will calculate individual mean coexistence using reach
criteria</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">indiv_species_reach_coex</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_reach_richness.html">IndivSpec_reach_richness</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_TS_TE_faurby</span>,</span>
<span>                           df.occ <span class="op">=</span> <span class="va">df_occ_faurby</span>,</span>
<span>                           time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                           round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                           species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                           TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                           TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                           Max.age <span class="op">=</span> <span class="st">"Max.age"</span>,</span>
<span>                           Min.age <span class="op">=</span> <span class="st">"Min.age"</span>,</span>
<span>                           lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                           lon <span class="op">=</span> <span class="st">"lng"</span><span class="op">)</span></span></code></pre></div>
<p>plotting individual species coexistence with reach criteria</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">indiv_species_reach_coex2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">indiv_species_reach_coex</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time.slice <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">indiv_species_reach_coex2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Ursus"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Simocyon"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Plionarctos"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Vormela"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Hesperocyon"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">n.coexistence</span>, color <span class="op">=</span> <span class="va">species</span>, group <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"mean coexistence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">indiv_species_site_coex2</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_reverse</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="individual-reach-coexistence-mpd">Individual reach coexistence mpd<a class="anchor" aria-label="anchor" href="#individual-reach-coexistence-mpd"></a>
</h4>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
