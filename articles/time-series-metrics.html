<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time series metrics • Buccaneer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time series metrics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Buccaneer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pre-processing-data.html">Pre processing data with Buccaneer</a></li>
    <li><a class="dropdown-item" href="../articles/time-series-metrics.html">Time series metrics</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Time series metrics</h1>
            
      

      <div class="d-none name"><code>time-series-metrics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gabrielnakamura.github.io/Buccaneer/">Buccaneer</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>In this article we will show how to calculate different metrics of
interspecific competition (or sometimes coexistence metrics) at
different taxonomic levels and spatial scales in deep time using
{<code>Buccaneer</code>} R package.</p>
<p>For all metrics we will use data from <span class="citation">Graciotti et al. (2025)</span>. The data comprises
fossil record of North American canids, a group that has been well
caracterized ecologically and regarding fossil record. This data is also
part of the {<code>Buccaneer</code>} package and is comprised by:</p>
<ul>
<li><p>Species longevity: A data frame describing the Origination Time
(TS) and Extinction Time (TE) obtained with Bayesian framework called <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12263" class="external-link">PyRate</a></p></li>
<li><p>Occurrence record data: A data frame with fossil occurrence
records retrieved from <a href="https://paleobiodb.org/#/" class="external-link">Paleobiology
Database</a> including only North American canids. For details in data
process and curatorial work check out <span class="citation">Graciotti
et al. (2025)</span></p></li>
<li><p>Species traits: A data frame with ecomorphological
characterization of species with traits that present important proxies
for determining species niches. For downstream analysis we use mostly
body mass and LDA to infer diet of species. For details on how this data
was computed see <span class="citation">Graciotti et al.
(2025)</span></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="loading-data-and-packages">Loading data and packages<a class="anchor" aria-label="anchor" href="#loading-data-and-packages"></a>
</h2>
<p>In the following examples, we will use three datasets that are
embedded in the <code>Buccaneer</code> package and can be loaded as
follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"df_longevities_canidae"</span><span class="op">)</span> <span class="co"># longevities for one replicate</span></span>
<span><span class="co">#data("occurrences_canidae") # occurrence data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"traits_canidae"</span><span class="op">)</span> <span class="co"># trait data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"df_occurrence_canidae"</span><span class="op">)</span> <span class="co"># occurrence data</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interspecific-competition-at-clade-level">Interspecific competition at clade level<a class="anchor" aria-label="anchor" href="#interspecific-competition-at-clade-level"></a>
</h2>
<p>At this section we present metrics to calculate proxy metrics that
represent interspecific competition at clade level. By competition at
clade level we mean the competition described by the variation in the
absolute number of coexisting species or by how the morphospace
occupation change through time. We perform this characterization at
different scales:</p>
<pre><code>- Regional: Considering all species present at a given time slice as 
    coexisting species
    
- Local (or Site): We consider a coexistence only species present at the 
    same timeslice and spatial area.
    
- Reach: A coexistence is considered only when the potential dispersion
   threshold distance in space between a pair of species is satisfied. 
   For more details in reach criteria see @graciotti_ecological_2025
   </code></pre>
<div class="section level3">
<h3 id="regional-scale">Regional scale<a class="anchor" aria-label="anchor" href="#regional-scale"></a>
</h3>
<p>Calculating time series at clade level and regional scale</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_regional</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/clade_regional_coexistence.html">clade_regional_coexistence</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>,</span>
<span>                             time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                             round.digits <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                             species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                             TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                             TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
<p>Here we calculate the mean distances using a general function that
allows to set up the group comparison in which the mean will be
calculate. It can be <code>between</code> to calculate mean distances
between a focal and a target group or <code>within</code> to calculate
the mean trait distance only within the focal group. To this end we will
use the <code>diet_cat</code> column of the <code>trait_canidae</code>
data frame, that contains a<br>
classification of canidae species in two categories: hypercarnivores and
mesocarnivores.</p>
<p>First we need to join this information to the
<code>df_longvities_canidae</code> data frame</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_longevities_canidae_trait</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">df_longevities_canidae</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">traits_canidae</span>, by <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span></span></code></pre></div>
<p>This function is also a general solution to calculate the mean trait
distance using different number of species/genus that are close to each
other. To set up the number of closest species that will be used in the
calculation of mean pairwise distances we will change the argument
<code>nearest.taxon</code>. 1 is equivalent of mean nearest distance and
<code>all</code> corresponds to the calculation of mean pairwise
distance (mpd) using all coexisting species.</p>
<p>The next chunk of code show an example on how we can calculate mean
distances in the morphospace using different types of comparisons and
varying the number of closest species in the morphospace considered in
the calculation</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ld1</span> <span class="op">&lt;-</span> <span class="va">traits_canidae</span><span class="op">$</span><span class="va">LD1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ld1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">traits_canidae</span><span class="op">$</span><span class="va">species</span></span>
<span><span class="va">dist_body_mass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">ld1</span><span class="op">)</span> <span class="co"># computing pairwise distance matrix for body mass</span></span>
<span></span>
<span><span class="co"># distances between groups using diet category </span></span>
<span><span class="va">res_regional_mnd_between</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_regional_distance.html">clade_regional_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae_trait</span>, </span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>,</span>
<span>                          nearest.taxon <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>, </span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                          group <span class="op">=</span> <span class="st">"diet_cat"</span>,</span>
<span>                          group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meso"</span>, <span class="st">"hyper"</span><span class="op">)</span>,</span>
<span>                          type.comparison <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># distance in morphospace computed within the focal group, in this case is mesocarnivores</span></span>
<span><span class="va">res_regional_mnd_within</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_regional_distance.html">clade_regional_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae_trait</span>, </span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                          dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>,</span>
<span>                          nearest.taxon <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>, </span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                          group <span class="op">=</span> <span class="st">"diet_cat"</span>, </span>
<span>                          group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meso"</span>, <span class="st">"meso"</span><span class="op">)</span>, </span>
<span>                          type.comparison <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s check out the results of these two competition metrics. First
we need to join the results to plot in one graphic</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_regional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">res_regional_mnd_between</span>, <span class="va">res_regional_mnd_within</span><span class="op">)</span></span>
<span><span class="va">all_mnd_regional2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">all_mnd_regional</span>, </span>
<span>             group_res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Between"</span>, <span class="st">"Within"</span><span class="op">)</span>, </span>
<span>                             each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">res_regional_mnd_within</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Plotting the results</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_regional</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time.slice <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.slice</span>, y <span class="op">=</span> <span class="va">coexistence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.6</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.4</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Coexistence"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res_clade_regional</span><span class="op">$</span><span class="va">time.slice</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      by   <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="2187.5"></p>
</div>
<div class="section level3">
<h3 id="site-scale">Site scale<a class="anchor" aria-label="anchor" href="#site-scale"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_site</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_site_coexistence.html">clade_site_coexistence</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>, </span>
<span>                         df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                         time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                         round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                         TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                         TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                         Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                         Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                         site <span class="op">=</span> <span class="st">"site.char"</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the results</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_site</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.coexistence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.coexistence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line thickness for better visibility</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean site coexistence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">res_clade_site</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can also calculate the distance in morphospace using site
criteria</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_site_distance</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_site_distance.html">clade_site_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>, </span>
<span>                      df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                      time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                      round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                      nearest.taxon <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                      TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                      TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                      Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                      Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                      site <span class="op">=</span> <span class="st">"site.char"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculating between mesocarnivores and hypercarnivores species</span></span>
<span><span class="va">res_clade_site_distance_between</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_site_distance.html">clade_site_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae_trait</span>, </span>
<span>                      df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                      time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                      round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                      nearest.taxon <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                      group <span class="op">=</span> <span class="st">"diet_cat"</span>, </span>
<span>                      group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meso"</span>, <span class="st">"hyper"</span><span class="op">)</span>, </span>
<span>                      type.comparison <span class="op">=</span> <span class="st">"between"</span>,</span>
<span>                      species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                      TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                      TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                      Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                      Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                      site <span class="op">=</span> <span class="st">"site.char"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in mean.default(x, na.rm = TRUE): argument is not numeric or logical:</span></span>
<span><span class="co">#&gt; returning NA</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span><span class="co">#&gt; Warning in var(x, na.rm = TRUE): NAs introduced by coercion</span></span>
<span></span>
<span><span class="co"># calculating within mesocarnivore species</span></span>
<span><span class="va">res_clade_site_distance_within</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_site_distance.html">clade_site_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae_trait</span>, </span>
<span>                      df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                      time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                      round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                      nearest.taxon <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                      group <span class="op">=</span> <span class="st">"diet_cat"</span>, </span>
<span>                      group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meso"</span>, <span class="st">"meso"</span><span class="op">)</span>, </span>
<span>                      type.comparison <span class="op">=</span> <span class="st">"within"</span>,</span>
<span>                      species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                      TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                      TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                      Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                      Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                      site <span class="op">=</span> <span class="st">"site.char"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s check out the results of these competition metrics. First we
need to join the results to plot in one graphic</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">res_clade_site_distance</span>, <span class="va">res_clade_site_distance_between</span>, <span class="va">res_clade_site_distance_within</span><span class="op">)</span></span>
<span><span class="va">all_mnd_site2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">all_mnd_site</span>, </span>
<span>             group_res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Between"</span>, <span class="st">"Within"</span><span class="op">)</span>, </span>
<span>                             each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">res_clade_site_distance</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Plotting the results</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_site2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.distance</span>, group <span class="op">=</span> <span class="va">group_res</span>, color <span class="op">=</span> <span class="va">group_res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.distance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean Nearest Distance"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Groups"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">all_mnd_site2</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 126 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 110 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level3">
<h3 id="reach-criteria">Reach criteria<a class="anchor" aria-label="anchor" href="#reach-criteria"></a>
</h3>
<p>Reach criteria for coexistence</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_reach_coexistence</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_reach_coexistence.html">clade_reach_coexistence</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>,</span>
<span>                          df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                          time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                          round.digits <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                          species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                          TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                          TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                          lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                          lon <span class="op">=</span> <span class="st">"lng"</span>,</span>
<span>                          Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                          Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                          crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Reach criteria for mean trait distance metrics</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_clade_reach_distance</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_reach_distance.html">clade_reach_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>,</span>
<span>                       df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                       time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                       dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                       nearest.taxon <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       round.digits <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                       species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                       TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                       TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                       lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                       lon <span class="op">=</span> <span class="st">"lng"</span>,</span>
<span>                       Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                       Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                       crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_clade_reach_distance_between</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_reach_distance.html">clade_reach_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae_trait</span>,</span>
<span>                       df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                       time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                       group <span class="op">=</span> <span class="st">"diet_cat"</span>,</span>
<span>                       group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meso"</span>, <span class="st">"hyper"</span><span class="op">)</span>,</span>
<span>                       type.comparison <span class="op">=</span> <span class="st">"between"</span>, </span>
<span>                       dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                       nearest.taxon <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       round.digits <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                       species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                       TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                       TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                       lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                       lon <span class="op">=</span> <span class="st">"lng"</span>,</span>
<span>                       Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                       Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                       crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_clade_reach_distance_within</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/clade_reach_distance.html">clade_reach_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae_trait</span>,</span>
<span>                       df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                       time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                       group <span class="op">=</span> <span class="st">"diet_cat"</span>,</span>
<span>                       group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meso"</span>, <span class="st">"hyper"</span><span class="op">)</span>,</span>
<span>                       type.comparison <span class="op">=</span> <span class="st">"within"</span>, </span>
<span>                       dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                       nearest.taxon <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       round.digits <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                       species <span class="op">=</span> <span class="st">"species"</span>, </span>
<span>                       TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                       TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                       lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                       lon <span class="op">=</span> <span class="st">"lng"</span>,</span>
<span>                       Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                       Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                       crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Joining the results and plotting</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_clade_reach</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">res_clade_reach_distance</span>, <span class="va">res_clade_reach_distance_between</span>, <span class="va">res_clade_reach_distance_within</span><span class="op">)</span></span>
<span><span class="va">all_mnd_clade_reach2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">all_mnd_clade_reach</span>, </span>
<span>             group_res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Between"</span>, <span class="st">"Within"</span><span class="op">)</span>, </span>
<span>                             each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">res_clade_reach_distance</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Plotting</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_mnd_clade_reach2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.distance</span>, group <span class="op">=</span> <span class="va">group_res</span>, color <span class="op">=</span> <span class="va">group_res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">time.slice</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">mean.distance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"loess"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Mean Nearest Distance"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Groups"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">all_mnd_clade_reach2</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.text  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 87 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 87 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="interspecific-competition-at-individual-species-level">Interspecific Competition at Individual Species Level<a class="anchor" aria-label="anchor" href="#interspecific-competition-at-individual-species-level"></a>
</h2>
<p>In individual species analyses the focus is on the “perception” of
each individual species with other co-occurring species. There are two
main components in this module. The first computes the number of species
in which a given species co-occur. The other is the mean distance
between a focal individual and its co-occurring species.</p>
<p>As the other modules there are four spatial levels in which we
compute the metrics. The regional level, that calculates the number of
co-occurrence by each focal species and all other species with
occurrence data in the specified time-slice. The site level, that
compute the taxonomic and trait metrics considering as co-existing
species only those that present occurrence in the same site (usually
defined accordingly to the PBDB definition of a site, or another
definition provided by the user). The reach level, that considers a
proxy of species dispersal capacity to infer the species that
potentially co-occurr. Finally, the assemblage level, that considers as
species co-occurring only those with an occurrence record in the same
assemblage, this last being defined as a grid of customized size.</p>
<div class="section level3">
<h3 id="regional-scale-1">Regional scale<a class="anchor" aria-label="anchor" href="#regional-scale-1"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_species_coex</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_regional_coex.html">IndivSpec_regional_coex</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>, </span>
<span>                             time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                             round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                             TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                             TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the time series for each species</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_species_coex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Aelurodon_ferox"</span>,</span>
<span>      <span class="st">"Psalidocyon_marianae"</span>,</span>
<span>      <span class="st">"Aelurodon_taxoides"</span>,</span>
<span>      <span class="st">"Phlaocyon_marslandensis"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time.slice</span>,</span>
<span>      y <span class="op">=</span> <span class="va">n.coexistence</span>,</span>
<span>      color <span class="op">=</span> <span class="va">species</span>,</span>
<span>      group <span class="op">=</span> <span class="va">species</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">species</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of coexistences by species"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res_indiv_species_coex</span><span class="op">$</span><span class="va">time.slice</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      by   <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.ticks.x       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.text.x        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.line.y.left   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    panel.grid.minor   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" alt="" width="700"></p>
<p>We can also plot individual species mpd for all species coexisting in
regional context. For this we will also use data on body mass for all
species. There are different ways in which mpd can be calculated. We can
calculate it using a single trait or a combination of traits. The later
require a distance trait matrix (passed to <code>dist</code> argument)
containing the pairwise distances among species.</p>
<p>Here we show how to calculate mpd using a single trait, in this case
body mass.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res_indiv_regional_species_mpd</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/IndivSpec_regional_distance.html">IndivSpec_regional_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>,</span>
<span>                              time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                              dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>,</span>
<span>                              round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                              species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                              TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                              TE <span class="op">=</span> <span class="st">"TE"</span>, </span>
<span>                              nearest.taxon <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the results for individual species mpd</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_regional_species_mpd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Aelurodon_ferox"</span>,</span>
<span>      <span class="st">"Psalidocyon_marianae"</span>,</span>
<span>      <span class="st">"Aelurodon_taxoides"</span>,</span>
<span>      <span class="st">"Phlaocyon_marslandensis"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time.slice</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean_dist_to_cooccur</span>,</span>
<span>      color <span class="op">=</span> <span class="va">species</span>,</span>
<span>      group <span class="op">=</span> <span class="va">species</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">species</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean pairwise distance"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res_indiv_regional_species_mpd</span><span class="op">$</span><span class="va">time.slice</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      by   <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.ticks.x       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.text.x        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.line.y.left   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    panel.grid.minor   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 1328 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 1328 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-20-1.png" class="r-plt" alt="" width="700"></p>
<p>In order to calculate the mpd for multiple traits the user must
inform an object of class dist containing all pairwise distances among
species. The function can handle distances in different ways. It can use
all pairwise distances to obtain the mpd, or the user can inform
throught the argument <code>nearest.taxon</code> the number of nearest
species that will be used to calculate the mpd. The default is
<code>all</code> which is the same as calculating the mpd considering
all species co-occurring in a time slice.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_regional_species_mnd</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_regional_distance.html">IndivSpec_regional_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>, </span>
<span>                            time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                            dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                            nearest.taxon <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            round.digits <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                            species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                            TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                            TE <span class="op">=</span> <span class="st">"TE"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="site-scale-1">Site scale<a class="anchor" aria-label="anchor" href="#site-scale-1"></a>
</h3>
<p>Here we will perform the same calculations but using site criteria
for individual species coexistence</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_species_site_coex</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_site_coexistence.html">IndivSpec_site_coexistence</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>,</span>
<span>                             df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                             time.slice <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                             round.digits <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                             species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                             TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                             TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                             Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                             Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                             site <span class="op">=</span> <span class="st">"site.char"</span><span class="op">)</span></span></code></pre></div>
<p>plotting species coexistence considering site coexistence</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_species_site_coex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Aelurodon_ferox"</span>,</span>
<span>      <span class="st">"Psalidocyon_marianae"</span>,</span>
<span>      <span class="st">"Aelurodon_taxoides"</span>,</span>
<span>      <span class="st">"Phlaocyon_marslandensis"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time.slice</span>,</span>
<span>      y <span class="op">=</span> <span class="va">n.coexistence</span>,</span>
<span>      color <span class="op">=</span> <span class="va">species</span>,</span>
<span>      group <span class="op">=</span> <span class="va">species</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">species</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of coexistences by species"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res_indiv_species_coex</span><span class="op">$</span><span class="va">time.slice</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      by   <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.ticks.x       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.text.x        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.line.y.left   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    panel.grid.minor   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-23-1.png" class="r-plt" alt="" width="700"></p>
<p>We can calculate mean pairwise distances of individual species
coexistence metrics based on site co-occurrence</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">indiv_species_site_mpd</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_site_distance.html">IndivSpec_site_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>, </span>
<span>                     df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>, </span>
<span>                     time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                     dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                     nearest.taxon <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>                     round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                     TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                     TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                     Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                     Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                     site <span class="op">=</span> <span class="st">"site.char"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reach-criteria-1">Reach criteria<a class="anchor" aria-label="anchor" href="#reach-criteria-1"></a>
</h3>
<p>We will calculate individual mean coexistence using reach
criteria</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res_indiv_species_reach_coex</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpecies_reach_coexistence.html">IndivSpecies_reach_coexistence</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>,</span>
<span>                                 df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>,</span>
<span>                                 time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                                 round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                 species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                                 TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                                 TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                                 Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                                 Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                                 lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                                 lon <span class="op">=</span> <span class="st">"lng"</span><span class="op">)</span></span></code></pre></div>
<p>plotting individual species coexistence with reach criteria</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res_indiv_species_reach_coex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Aelurodon_ferox"</span>,</span>
<span>      <span class="st">"Psalidocyon_marianae"</span>,</span>
<span>      <span class="st">"Aelurodon_taxoides"</span>,</span>
<span>      <span class="st">"Phlaocyon_marslandensis"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time.slice</span>,</span>
<span>      y <span class="op">=</span> <span class="va">n.coexistence</span>,</span>
<span>      color <span class="op">=</span> <span class="va">species</span>,</span>
<span>      group <span class="op">=</span> <span class="va">species</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">species</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of coexistences by species"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res_indiv_species_reach_coex</span><span class="op">$</span><span class="va">time.slice</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      by   <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.ticks.x       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.text.x        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.line.y.left   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    panel.grid.minor   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-26-1.png" class="r-plt" alt="" width="700"></p>
<p>Individual reach coexistence mpd and mnd</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_species_reach_distance</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/IndivSpec_reach_distance.html">IndivSpec_reach_distance</a></span><span class="op">(</span>df.TS.TE <span class="op">=</span> <span class="va">df_longevities_canidae</span>, </span>
<span>                           dist.trait <span class="op">=</span> <span class="va">dist_body_mass</span>, </span>
<span>                           nearest.taxon <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>                           crs <span class="op">=</span> <span class="fl">4326</span>, </span>
<span>                           df.occ <span class="op">=</span> <span class="va">df_occurrence_canidae</span>,</span>
<span>                           time.slice <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                           round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                           species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>                           TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>                           TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>                           Max.age <span class="op">=</span> <span class="st">"max_T"</span>,</span>
<span>                           Min.age <span class="op">=</span> <span class="st">"min_T"</span>,</span>
<span>                           lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>                           lon <span class="op">=</span> <span class="st">"lng"</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the result</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_indiv_species_reach_distance</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Aelurodon_ferox"</span>,</span>
<span>      <span class="st">"Psalidocyon_marianae"</span>,</span>
<span>      <span class="st">"Aelurodon_taxoides"</span>,</span>
<span>      <span class="st">"Phlaocyon_marslandensis"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">time.slice</span>,</span>
<span>      y <span class="op">=</span> <span class="va">mean_dist_to_cooccur</span>,</span>
<span>      color <span class="op">=</span> <span class="va">species</span>,</span>
<span>      group <span class="op">=</span> <span class="va">species</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span></span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"loess"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">species</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean individual distance in morphospace"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_reverse</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      to   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res_indiv_species_reach_distance</span><span class="op">$</span><span class="va">time.slice</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>      by   <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    axis.line.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.ticks.x       <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    axis.text.x        <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    axis.line.y.left   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    panel.grid.minor   <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">20</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span>
<span><span class="co">#&gt; Warning: Removed 1328 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_smooth()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 1328 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="time-series-metrics_files/figure-html/unnamed-chunk-28-1.png" class="r-plt" alt="" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="interspecific-competition-at-assemblage-level">Interspecific Competition at Assemblage Level<a class="anchor" aria-label="anchor" href="#interspecific-competition-at-assemblage-level"></a>
</h2>
<p>Calculating distance metrics at site and grid scale</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-graciotti_ecological_2025" class="csl-entry">
Graciotti, Rodolfo P, Lucas M V Porto, Salatiel Gonçalves-Neto, and
Tiago B Quental. 2025. <span>“Ecological and Spatial Overlap Indicate
Interspecific Competition During <span>North</span>
<span>American</span> Canid Radiation.”</span> Edited by Stewart Edie
and Hélène Morlon. <em>Evolution</em> 79 (9): 1835–47. <a href="https://doi.org/10.1093/evolut/qpaf113" class="external-link">https://doi.org/10.1093/evolut/qpaf113</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel Nakamura, Tiago Quental.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
