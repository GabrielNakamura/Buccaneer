<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check Occurrence Records Crossing Time Bin Boundaries — check_crossing_boundaries • Buccaneer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check Occurrence Records Crossing Time Bin Boundaries — check_crossing_boundaries"><meta name="description" content="This function analyzes how fossil occurrence records align with predefined
time bins by classifying each record based on whether its age uncertainty
(minimum and maximum ages) falls completely within a bin, crosses one boundary,
or spans multiple bins. This is useful for assessing data quality and understanding
the temporal resolution of fossil occurrences relative to time bins used in analyses."><meta property="og:description" content="This function analyzes how fossil occurrence records align with predefined
time bins by classifying each record based on whether its age uncertainty
(minimum and maximum ages) falls completely within a bin, crosses one boundary,
or spans multiple bins. This is useful for assessing data quality and understanding
the temporal resolution of fossil occurrences relative to time bins used in analyses."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Buccaneer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pre-processing-data.html">Pre processing data with Buccaneer</a></li>
    <li><a class="dropdown-item" href="../articles/time-series-metrics.html">Time series metrics</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Check Occurrence Records Crossing Time Bin Boundaries</h1>

      <div class="d-none name"><code>check_crossing_boundaries.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function analyzes how fossil occurrence records align with predefined
time bins by classifying each record based on whether its age uncertainty
(minimum and maximum ages) falls completely within a bin, crosses one boundary,
or spans multiple bins. This is useful for assessing data quality and understanding
the temporal resolution of fossil occurrences relative to time bins used in analyses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_crossing_boundaries</span><span class="op">(</span></span>
<span>  <span class="va">df.occ.fossil</span>,</span>
<span>  <span class="va">interval</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  Max.age <span class="op">=</span> <span class="st">"Maximum_Age"</span>,</span>
<span>  Min.age <span class="op">=</span> <span class="st">"Minimum_Age"</span>,</span>
<span>  remove.sub.species <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df-occ-fossil">df.occ.fossil<a class="anchor" aria-label="anchor" href="#arg-df-occ-fossil"></a></dt>
<dd><p>A data frame containing fossil occurrence records with at
least three columns: species names, maximum (oldest) age estimates, and
minimum (youngest) age estimates. Each row represents a single occurrence
record with age uncertainty.</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>Numeric vector. A sequence of time bin boundaries in descending
order (from oldest to youngest). For example, <code>c(100, 90, 80, 70)</code>
creates three time bins: 100-90, 90-80, and 80-70. Must have at least
two elements.</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>Character. The name of the column in <code>df.occ.fossil</code>
containing species identifiers. Default is "species".</p></dd>


<dt id="arg-max-age">Max.age<a class="anchor" aria-label="anchor" href="#arg-max-age"></a></dt>
<dd><p>Character. The name of the column in <code>df.occ.fossil</code>
containing the maximum (oldest) age estimate for each occurrence record.
Default is "Maximum_Age".</p></dd>


<dt id="arg-min-age">Min.age<a class="anchor" aria-label="anchor" href="#arg-min-age"></a></dt>
<dd><p>Character. The name of the column in <code>df.occ.fossil</code>
containing the minimum (youngest) age estimate for each occurrence record.
Default is "Minimum_Age".</p></dd>


<dt id="arg-remove-sub-species">remove.sub.species<a class="anchor" aria-label="anchor" href="#arg-remove-sub-species"></a></dt>
<dd><p>Logical. Should subspecies-level identifications be
removed, keeping only species-level records? Default is TRUE. This parameter
is passed to <code><a href="clean_occ_fossil.html">clean_occ_fossil()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing two elements:</p>
<dl><dt>summary_table</dt>
<dd><p>A named numeric vector showing the percentage of
occurrence records in each category:</p><ul><li><p><code>within</code>: Records completely contained within a time bin</p></li>
<li><p><code>upper_only</code>: Records crossing only the upper (older) boundary</p></li>
<li><p><code>lower_only</code>: Records crossing only the lower (younger) boundary</p></li>
<li><p><code>both</code>: Records spanning an entire time bin (crossing both boundaries)</p></li>
</ul></dd>

<dt>df_records_interval</dt>
<dd><p>A data frame containing all occurrence records
with added columns:</p><ul><li><p><code>boundaries</code>: Classification of boundary crossing (one of the
four categories above)</p></li>
<li><p><code>time.interval</code>: The time bin identifier (e.g., "100-90")</p></li>
<li><p>All original columns from the cleaned occurrence data</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function classifies each occurrence record into one of four categories:</p><ol><li><p><strong>within</strong>: Both Max.age and Min.age fall within the time bin
boundaries (Max.age &lt;= upper boundary AND Min.age &gt;= lower boundary)</p></li>
<li><p><strong>upper_only</strong>: The record crosses the upper (older) boundary
(Max.age &gt; upper boundary BUT Min.age is within the bin)</p></li>
<li><p><strong>lower_only</strong>: The record crosses the lower (younger) boundary
(Min.age &lt; lower boundary BUT Max.age is within the bin)</p></li>
<li><p><strong>both</strong>: The record spans the entire time bin, crossing both
boundaries (Max.age &gt;= upper boundary AND Min.age &lt;= lower boundary)</p></li>
</ol><p>Before classification, the function calls <code><a href="clean_occ_fossil.html">clean_occ_fossil()</a></code> to:</p><ul><li><p>Calculate midpoint ages</p></li>
<li><p>Optionally remove subspecies-level identifications</p></li>
<li><p>Standardize column names</p></li>
</ul><p>Records crossing boundaries indicate age uncertainty that exceeds the
temporal resolution of the time bins. High percentages of crossing records
may suggest that finer time bins or different binning strategies should be
considered for the analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create example fossil occurrence data with age uncertainties</span></span></span>
<span class="r-in"><span><span class="va">df_fossils</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="st">"sp2"</span>, <span class="st">"sp3"</span>, <span class="st">"sp4"</span>, <span class="st">"sp5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Maximum_Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">95</span>, <span class="fl">105</span>, <span class="fl">88</span>, <span class="fl">92</span>, <span class="fl">110</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Minimum_Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">95</span>, <span class="fl">82</span>, <span class="fl">78</span>, <span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define time bins (100-90, 90-80, 80-70)</span></span></span>
<span class="r-in"><span><span class="va">time_bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">90</span>, <span class="fl">80</span>, <span class="fl">70</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check boundary crossing patterns</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">check_crossing_boundaries</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df.occ.fossil <span class="op">=</span> <span class="va">df_fossils</span>,</span></span>
<span class="r-in"><span>  interval <span class="op">=</span> <span class="va">time_bins</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View summary of boundary crossing</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">summary_table</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View detailed classification for all records</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">df_records_interval</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Filter records that span entire bins</span></span></span>
<span class="r-in"><span><span class="va">spanning_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">results</span><span class="op">$</span><span class="va">df_records_interval</span>,</span></span>
<span class="r-in"><span>  <span class="va">boundaries</span> <span class="op">==</span> <span class="st">"both"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize boundary crossing patterns</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">df_records_interval</span>,</span></span>
<span class="r-in"><span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time.interval</span>, fill <span class="op">=</span> <span class="va">boundaries</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportion"</span>, x <span class="op">=</span> <span class="st">"Time Interval"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate statistics by time interval</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">interval_summary</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">df_records_interval</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">time.interval</span>, <span class="va">boundaries</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel Nakamura, Tiago Quental.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

