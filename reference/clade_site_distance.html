<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Mean Site-Level Trait Distances Across Time Slices — clade_site_distance • Buccaneer</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Mean Site-Level Trait Distances Across Time Slices — clade_site_distance"><meta name="description" content="This function computes mean trait distances between co-occurring species at
individual sites across different time slices. For each time slice, it calculates
the mean distance for all species across all sites where they co-occur, then
aggregates these individual species distances to obtain a time slice-level mean
and variance."><meta property="og:description" content="This function computes mean trait distances between co-occurring species at
individual sites across different time slices. For each time slice, it calculates
the mean distance for all species across all sites where they co-occur, then
aggregates these individual species distances to obtain a time slice-level mean
and variance."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Buccaneer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/assemblage-time-series.html">Building time series based on species coexistence</a></li>
    <li><a class="dropdown-item" href="../articles/pre-processing-data.html">pre-processing-data</a></li>
    <li><a class="dropdown-item" href="../articles/time-series-metrics.html">Time series metrics</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Mean Site-Level Trait Distances Across Time Slices</h1>

      <div class="d-none name"><code>clade_site_distance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes mean trait distances between co-occurring species at
individual sites across different time slices. For each time slice, it calculates
the mean distance for all species across all sites where they co-occur, then
aggregates these individual species distances to obtain a time slice-level mean
and variance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clade_site_distance</span><span class="op">(</span></span>
<span>  <span class="va">df.TS.TE</span>,</span>
<span>  <span class="va">df.occ</span>,</span>
<span>  <span class="va">time.slice</span>,</span>
<span>  <span class="va">dist.trait</span>,</span>
<span>  <span class="va">nearest.taxon</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group.focal.compare <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type.comparison <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trait <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  round.digits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  TS <span class="op">=</span> <span class="st">"TS"</span>,</span>
<span>  TE <span class="op">=</span> <span class="st">"TE"</span>,</span>
<span>  Max.age <span class="op">=</span> <span class="st">"Max.age"</span>,</span>
<span>  Min.age <span class="op">=</span> <span class="st">"Min.age"</span>,</span>
<span>  site <span class="op">=</span> <span class="st">"site"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df-ts-te">df.TS.TE<a class="anchor" aria-label="anchor" href="#arg-df-ts-te"></a></dt>
<dd><p>A data frame containing species temporal and trait data with
at least four columns: species names, origination times (TS), extinction
times (TE), and trait values. Additional columns may include group assignments.</p></dd>


<dt id="arg-df-occ">df.occ<a class="anchor" aria-label="anchor" href="#arg-df-occ"></a></dt>
<dd><p>A data frame containing fossil occurrence records with at least
four columns: species names, minimum age, maximum age, and site location ID.
Each row represents a single occurrence record at a specific site.</p></dd>


<dt id="arg-time-slice">time.slice<a class="anchor" aria-label="anchor" href="#arg-time-slice"></a></dt>
<dd><p>Numeric. The time interval (in the same units as TS and TE)
between consecutive time slices for temporal binning.</p></dd>


<dt id="arg-dist-trait">dist.trait<a class="anchor" aria-label="anchor" href="#arg-dist-trait"></a></dt>
<dd><p>A distance matrix object (class <code>dist</code> or <code>matrix</code>)
containing pairwise trait distances between species. Row and column names
must match species names in <code>df.TS.TE</code>. If NULL, distances will be
computed from the trait column using Euclidean distance.</p></dd>


<dt id="arg-nearest-taxon">nearest.taxon<a class="anchor" aria-label="anchor" href="#arg-nearest-taxon"></a></dt>
<dd><p>Numeric or character. The number of nearest neighbors to
consider when calculating mean distances. Use <code>1</code> for mean nearest
neighbor distance (MNND), or <code>"all"</code> for mean pairwise distance (MPD).</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Character. The name of the column in <code>df.TS.TE</code> containing
group assignments for species (e.g., clade, family). Required if using
<code>group.focal.compare</code>. Default is NULL.</p></dd>


<dt id="arg-group-focal-compare">group.focal.compare<a class="anchor" aria-label="anchor" href="#arg-group-focal-compare"></a></dt>
<dd><p>Character vector of length 2. The first element
specifies the focal group and the second specifies the comparison group.
If NULL (default), distances are calculated across all species regardless
of group membership.</p></dd>


<dt id="arg-type-comparison">type.comparison<a class="anchor" aria-label="anchor" href="#arg-type-comparison"></a></dt>
<dd><p>Character. Specifies the type of distance comparison:</p><ul><li><p><code>"between"</code>: Calculate distances only between species from
the focal and comparison groups.</p></li>
<li><p><code>"within"</code>: Calculate distances only among species within
the focal group.</p></li>
<li><p>NULL (default): Calculate distances among all species together.</p></li>
</ul></dd>


<dt id="arg-trait">trait<a class="anchor" aria-label="anchor" href="#arg-trait"></a></dt>
<dd><p>Character. The name of the column in <code>df.TS.TE</code> containing
trait values. If NULL (default), <code>dist.trait</code> must be provided.</p></dd>


<dt id="arg-round-digits">round.digits<a class="anchor" aria-label="anchor" href="#arg-round-digits"></a></dt>
<dd><p>Integer. The number of decimal places to round time slice
values. Default is 1. This affects temporal binning precision.</p></dd>


<dt id="arg-species">species<a class="anchor" aria-label="anchor" href="#arg-species"></a></dt>
<dd><p>Character. The name of the column in <code>df.TS.TE</code> and
<code>df.occ</code> containing species identifiers. Default is "species".</p></dd>


<dt id="arg-ts">TS<a class="anchor" aria-label="anchor" href="#arg-ts"></a></dt>
<dd><p>Character. The name of the column in <code>df.TS.TE</code> containing
origination (first appearance) times for each species. Default is "TS".</p></dd>


<dt id="arg-te">TE<a class="anchor" aria-label="anchor" href="#arg-te"></a></dt>
<dd><p>Character. The name of the column in <code>df.TS.TE</code> containing
extinction (last appearance) times for each species. Default is "TE".</p></dd>


<dt id="arg-max-age">Max.age<a class="anchor" aria-label="anchor" href="#arg-max-age"></a></dt>
<dd><p>Character. The name of the column in <code>df.occ</code> containing
the maximum (oldest) age estimate for each occurrence record. Default is "Max.age".</p></dd>


<dt id="arg-min-age">Min.age<a class="anchor" aria-label="anchor" href="#arg-min-age"></a></dt>
<dd><p>Character. The name of the column in <code>df.occ</code> containing
the minimum (youngest) age estimate for each occurrence record. Default is "Min.age".</p></dd>


<dt id="arg-site">site<a class="anchor" aria-label="anchor" href="#arg-site"></a></dt>
<dd><p>Character. The name of the column in <code>df.occ</code> containing
site location identifiers. Default is "site".</p></dd>


<dt id="arg-remove-singletons">remove.singletons<a class="anchor" aria-label="anchor" href="#arg-remove-singletons"></a></dt>
<dd><p>Logical. Should singleton species (species occurring
alone at a site with no co-occurring species) be excluded from mean and
variance calculations? Default is TRUE. When TRUE, singletons are assigned
a distance of 0 but may be excluded from aggregation depending on implementation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with three columns:</p>
<dl><dt>mean.distance</dt>
<dd><p>Numeric. The mean trait distance across all species-site
combinations within each time slice. This is calculated by first computing
mean distances for each species to its co-occurring species at sites,
then averaging these values across all species in the time slice.
Returns NA when there is no species occurrence in the time slice and
NA_singleton when there is only one species occurring</p></dd>

<dt>var.distance</dt>
<dd><p>Numeric. The variance of trait distances across all
species-site combinations within each time slice.</p></dd>

<dt>time.slice</dt>
<dd><p>Numeric. The time point representing each slice, typically
the upper (older) boundary of the time bin.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps:</p><ol><li><p>Creates time slices from maximum TS to minimum TE</p></li>
<li><p>Generates regional co-occurrence matrices using <code><a href="aux_matrix_regional_coex.html">aux_matrix_regional_coex()</a></code></p></li>
<li><p>Determines which species occur at which sites in each time slice</p></li>
<li><p>Creates site-based co-occurrence matrices using <code><a href="comp_site_cooccurr.html">comp_site_cooccurr()</a></code></p></li>
<li><p>For each species at each site, calculates mean distances to co-occurring species</p></li>
<li><p>Aggregates individual species distances to obtain time slice-level mean and variance</p></li>
<li><p>Optionally filters by group membership</p></li>
</ol><p>Distance calculation hierarchy:</p><ol><li><p><strong>Species-site level</strong>: For each species at each site, calculate
mean distance to co-occurring species (based on <code>nearest.taxon</code>)</p></li>
<li><p><strong>Time slice level</strong>: Average all species-site distances within
each time slice to obtain overall mean and variance</p></li>
</ol><p>Special cases:</p><ul><li><p><strong>Singleton species</strong>: Species with no co-occurring taxa at a site
are assigned distance = 0 and flagged (treatment depends on <code>remove.singletons</code>)</p></li>
<li><p><strong>Missing data</strong>: Time slices with no occurrences return NA</p></li>
<li><p><strong>Group comparisons</strong>: When using <code>group.focal.compare</code>,
only distances between/within specified groups are computed</p></li>
</ul><p>This function differs from <code><a href="IndivSpec_site_distance.html">IndivSpec_site_distance()</a></code> by aggregating
to the time slice level rather than returning individual species-level results.
For regional-scale (non-site-based) distances, see <code><a href="clade_regional_distance.html">clade_regional_distance()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create example fossil data with traits</span></span></span>
<span class="r-in"><span><span class="va">df_temporal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="st">"sp2"</span>, <span class="st">"sp3"</span>, <span class="st">"sp4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  TS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">95</span>, <span class="fl">90</span>, <span class="fl">85</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  TE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">45</span>, <span class="fl">40</span>, <span class="fl">35</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2.5</span>, <span class="fl">3.1</span>, <span class="fl">4.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_occurrences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp1"</span>, <span class="st">"sp1"</span>, <span class="st">"sp2"</span>, <span class="st">"sp3"</span>, <span class="st">"sp4"</span>, <span class="st">"sp4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Max.age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">95</span>, <span class="fl">95</span>, <span class="fl">90</span>, <span class="fl">85</span>, <span class="fl">85</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Min.age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">85</span>, <span class="fl">85</span>, <span class="fl">80</span>, <span class="fl">75</span>, <span class="fl">75</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site1"</span>, <span class="st">"site2"</span>, <span class="st">"site1"</span>, <span class="st">"site1"</span>, <span class="st">"site2"</span>, <span class="st">"site3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate mean site-level MPD through time</span></span></span>
<span class="r-in"><span><span class="va">result_mpd</span> <span class="op">&lt;-</span> <span class="fu">clade_site_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df.TS.TE <span class="op">=</span> <span class="va">df_temporal</span>,</span></span>
<span class="r-in"><span>  df.occ <span class="op">=</span> <span class="va">df_occurrences</span>,</span></span>
<span class="r-in"><span>  time.slice <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  dist.trait <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  nearest.taxon <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>  trait <span class="op">=</span> <span class="st">"trait"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot mean distance through time</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">time.slice</span>,</span></span>
<span class="r-in"><span>     <span class="va">result_mpd</span><span class="op">$</span><span class="va">mean.distance</span>,</span></span>
<span class="r-in"><span>     type <span class="op">=</span> <span class="st">"l"</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"Time (Ma)"</span>,</span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="st">"Mean Site-Level Trait Distance"</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"Mean Trait Distance at Sites Through Time"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add variance as error bands</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">time.slice</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">time.slice</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">mean.distance</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">var.distance</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">mean.distance</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">result_mpd</span><span class="op">$</span><span class="va">var.distance</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate MNND at sites</span></span></span>
<span class="r-in"><span><span class="va">result_mnnd</span> <span class="op">&lt;-</span> <span class="fu">clade_site_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df.TS.TE <span class="op">=</span> <span class="va">df_temporal</span>,</span></span>
<span class="r-in"><span>  df.occ <span class="op">=</span> <span class="va">df_occurrences</span>,</span></span>
<span class="r-in"><span>  time.slice <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  dist.trait <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  nearest.taxon <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  trait <span class="op">=</span> <span class="st">"trait"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate distances between groups at sites</span></span></span>
<span class="r-in"><span><span class="va">result_between</span> <span class="op">&lt;-</span> <span class="fu">clade_site_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df.TS.TE <span class="op">=</span> <span class="va">df_temporal</span>,</span></span>
<span class="r-in"><span>  df.occ <span class="op">=</span> <span class="va">df_occurrences</span>,</span></span>
<span class="r-in"><span>  time.slice <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  dist.trait <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  nearest.taxon <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>  trait <span class="op">=</span> <span class="st">"trait"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>  group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type.comparison <span class="op">=</span> <span class="st">"between"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate distances within a single group at sites</span></span></span>
<span class="r-in"><span><span class="va">result_within</span> <span class="op">&lt;-</span> <span class="fu">clade_site_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df.TS.TE <span class="op">=</span> <span class="va">df_temporal</span>,</span></span>
<span class="r-in"><span>  df.occ <span class="op">=</span> <span class="va">df_occurrences</span>,</span></span>
<span class="r-in"><span>  time.slice <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  dist.trait <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  nearest.taxon <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>  trait <span class="op">=</span> <span class="st">"trait"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>  group.focal.compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type.comparison <span class="op">=</span> <span class="st">"within"</span>,</span></span>
<span class="r-in"><span>  remove.singletons <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gabriel Nakamura, Tiago Quental.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

